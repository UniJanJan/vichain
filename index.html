<html lang="en">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Blockchain simulator</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN" crossorigin="anonymous">
</head>

<body>
    <div class="container-fluid text-center d-flex flex-column" style="height: 100vh">
        <div class="row">
            <div class="col-12">
                <h2>Blockchain simulator</h2>
            </div>
        </div>
        <div class="row bg-light align-items-center justify-content-top" style="flex: 1 1 auto; height: 100%;">
            <div class="col-9" id="visualisation-div" style="height: 100%; margin: 0;">
                <canvas id="visualisation-canvas" style="border-style: double; height: 100%; width: 100%;"></canvas>
            </div>
            <div id="app" class="col-3">
                <div v-if="network.selectedNode">
                    Node {{ network.selectedNode.id }}
                    <!-- <div v-if="network.selectedNode.eventProcessor.events.length > 0">
                    {{ network.selectedNode.eventProcessor.events[0] }}
                    </div> -->
                </div>
                <div v-else>
                    <p>
                        Ctrl + left click = new node
                    </p>
                </div>
                <div v-if="events.length > 0">
                    Events
                    <li v-for="event in events">
                        <pre>{{ JSON.stringify(event.message) }}</pre>
                    </li>
                </div>
            </div>
        </div>
        <div class="row">
            <div class="col-12">
                <h3>footer</h2>
            </div>
        </div>
    </div>
</body>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"
    integrity="sha384-C6RzsynM9kWDrMNeT87bh95OGNyZPhcTNXj1NW7RuBCsyN/o0jlpcV8Qyq46cDfL"
    crossorigin="anonymous"></script>

<script src="./common.js"></script>
<script src="./node.js"></script>
<script src="./link.js"></script>
<script src="./event.js"></script>
<script src="./event_processor.js"></script>
<script src="./network.js"></script>

<script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
<script src="https://unpkg.com/vuex@4.0.0/dist/vuex.global.js"></script>

<script>
    const { createApp, ref } = Vue
    // const { mapState } = Vuex
    // const network = new Network();

    const app = createApp({
        data() {
            return {
                network: ref(new Network())
            }
        },
        computed: {
            // events: {
            //     cache: false,
            //     get() {
            //         return this.network.selectedNode ? this.network.selectedNode.eventProcessor.processedEvents : [];
            //     }
            // }
            events() {
                return this.network.selectedNode ? this.network.selectedNode.eventProcessor.processedEvents : [];
            }
        }
    });

    app.mount('#app');
</script>

<script src="./index.js"></script>

</html>